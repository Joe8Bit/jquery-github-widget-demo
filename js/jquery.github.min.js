/*
 * jQuery Github Widget
 * Author: Joe Pettersson, @Joe8Bit
 * http://www.joepettersson.com/jquery-github-widget
 * https://github.com/JoePettersson/jquery-github-widget
 * Licensed under the MIT license
 * Version: 1.0
 *
 * Options:
 * 		user: [String] the username of the user for whom we're building the widget
 * 		show_extended_info: [Boolean] when someone hovers over the avatar, more detailed user info is shown
 * 		show_follows: [Boolean] show the number of followers a user has in the widget header
 * 		width: [String] a CSS compliant value representing a width (px/%/em/pt)
 * 		show_repos: [Number] The number of repos that should be displayed
 * 		oldest_first: [Boolean] The default is to show the most recent repo first, set this to true to show the oldest first
 * 		
 */(function($,window,document,undefined){"use strict";function Github(element,options){this.element=element,this.options=$.extend({},defaults,options),this.init()}var pluginName="github",defaults={user:"joepettersson",show_extended_info:!0,show_follows:!0,width:"400px",show_repos:10,oldest_first:!1};Github.prototype={init:function(){var el=this.element,options=this.options,user=this.model("user",options.user,function(data){$(el).append(Github.prototype.view_layout(data.data,options))}),repos=this.model("repos",options.user,function(data){$(el).find("#repos ul").append(Github.prototype.view_partial_repos(data,options,el)),$(el).find("#repos #github-loader").fadeOut(250,function(){$(el).find("#repos ul").slideDown(250)}),Github.prototype.bind(options)})},model:function(type,user,callback){var url="https://api.github.com/users/"+user.toLowerCase();type==="repos"&&(url+="/repos"),url+="?callback=?",$.getJSON(url,function(data){typeof callback!="undefined"&&typeof callback=="function"&&callback(data)})},view_layout:function(user,options){var markup="";return markup+='<div id="github" style="width: '+options.width+'">',markup+='<div id="header" class="clear">',markup+='<div id="logo"><a href="https://github.com/">Github</a></div>',markup+='<div id="user"><a href="'+user.html_url+'" id="github-user">',typeof user.avatar_url!="undefined"&&user.avatar_url.length>0?markup+='<img src="'+user.avatar_url+'" alt="Avatar" width="34px" height="34px" />':markup+='<img src="https://a248.e.akamai.net/assets.github.com/images/gravatars/gravatar-140.png" alt="Avatar" width="34px" height="34px" />',markup+="</a></div>",options.show_extended_info===!0&&(markup+='<div id="extended-user-info">',typeof user.name!="undefined"&&user.name.length>0&&(markup+='<p class="name">'+user.name+"</p>"),markup+='<p class="place">',typeof user.company!="undefined"&&user.company.length>0&&(markup+=user.company+" "),typeof user.location!="undefined"&&user.location.length>0&&(markup+=user.location),markup+="</p>",typeof user.bio!="undefined"&&user.bio.length>0&&(markup+='<p class="bio">'+user.bio+"</p>"),user.hireable===!0&&(markup+='<p class="hireable">I\'m availabe for hire!</p>'),markup+='<span class="repos">'+user.public_repos+" repos</span>",markup+='<span class="gists">'+user.public_gists+" gists</span>",markup+="</div>"),markup+='<div id="github-user-data">',markup+='<h2><a href="'+user.html_url+'">'+user.login+"</a></h2>",markup+='<a href="'+user.html_url+'" id="header-total-repos">'+user.public_repos+" repos</a>",options.show_follows===!0&&(markup+=' | <a href="https://github.com/'+user.login.toLowerCase()+'/followers" id="current-followers">'+user.followers+" followers</a>"),markup+="</div>",markup+="</div>",markup+='<div id="repos"><div id="github-loader"></div><ul></ul></div>',markup+="</div>",markup},view_partial_repos:function(data,options,el){var markup="";if(options.oldest_first===!0)var data=data.data.reverse();else var data=data.data;return $.each(data,function(i){i<=options.show_repos-1&&(markup+='<li id="repo-'+i+'" class="clear repo',this.language!==null&&(markup+=" double"),markup+='">',markup+='<div class="left">',markup+='<p class="title"><a href="'+this.html_url+'" data-description="<p>'+this.name+"</p>"+this.description+'" class="github-tooltip">'+this.name+"</a></p>",markup+='<p class="meta-data">',this.language!==null&&(markup+='<span class="language">'+this.language+"</span></p>"),markup+="</div>",markup+='<div class="right">',markup+='<span class="forks github-tooltip" data-description="This repo has '+this.forks+' fork(s)">'+this.forks+"</span>",markup+='<span class="watchers github-tooltip" data-description="This repo has '+this.watchers+' watcher(s)">'+this.watchers+"</span>",markup+='<span class="issues github-tooltip" data-description="This project has '+this.open_issues+' open issues">'+this.open_issues+"</span>",markup+="</div>",markup+="</li>")}),markup},bind:function(options){options.show_extended_info===!0&&$("#github-user").hover(function(){$("#github #header #extended-user-info").fadeIn(250,function(){$("#github #header img").addClass("no-bottom-border")})},function(){$("#github #header #extended-user-info").fadeOut(250,function(){$("#github #header img").removeClass("no-bottom-border")})}),$("#github li").hover(function(){$(this).find(".right").animate({opacity:1},200)},function(){$(this).find(".right").animate({opacity:.3},200)}),$(".github-tooltip").hover(function(){var markup='<div class="github-tooltip-content">'+$(this).attr("data-description")+"</div>";$(this).append(markup)},function(){$(".github-tooltip-content").remove()})}},$.fn[pluginName]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new Github(this,options))})}})(jQuery,window,document);